{% extends 'AppCofidurBundle::layout.html.twig' %}

{% block body %}
	<script type="text/javascript">
		function show_details(indice_category){
			var details_block= document.getElementById("operatorformation_informations".concat(indice_category));
			var details_button= document.getElementById("details".concat(indice_category));

			if(details_block.style.display == "none"){
				details_block.style.display= "block";
			} else {
				details_block.style.display= "none";
			}
		}
	</script>

	<h1 class="page_title">Formation d'un opérateur</h1>

	<!-- idOperator, idFormation, dateBegin, dateEnd, validation, commentary, idFormer-->
	<fieldset class="operatorformation_sumup">
		<legend> Formation operateur </legend>
		<table class="operatorformation_ids">
			<tr>
				<th>ID operateur</th>
				<td> {{ operatorformation.idOperator }}</td>
			</tr>
			<tr>
				<th>ID formation</th>
				<td> {{ operatorformation.idFormation}}</td>
			</tr>
			<tr>
				<th>ID formateur</th>
				<td> {{ operatorformation.idFormer }}</td>
			</tr>
		</table>
		<table class="operatorformation_dates">
			<tr>
				<th>Date de début</th>
				<td> {{ operatorformation.dateBegin|date("m/d/Y")}}</td>
			</tr>
			<tr>
				<th>Date de fin</th>
				<td> {{ operatorformation.dateEnd|date("m/d/Y") }}</td>
			</tr>
		</table>

	</fieldset>
	<fieldset class="operatorformation_sumup">
		<legend>Résumé de la formation</legend>
		<table class="category_page">
			<tr>
				<th class="entete_category">ID</th>
				<th class="entete_category">Name</th>
				<th class="entete_category">Type</th>
				<th class="entete_category">Objectif</th>
				<th class="entete_category">Moyens pédagogiques</th>
				<th class="entete_category">Lieu & moyens matériels</th>
				<th class="entete_category">Criticité</th>
			</tr>
			<tr>
				<td>{{ formation.id }} </td>
				<td>{{ formation.name }} </td>
				<td>{{ formation.type }} </td>
				<td>{{ formation.goal }} </td>
				<td>{{ formation.teachingAids }} </td>
				<td>{{ formation.placesMaterialRessources }} </td>
				<td>{{ formation.criticality }} </td>
			</tr>
		</table>
	</fieldset>
	<fieldset class="operatorformation_sumup">
		<legend>Résumé de l'opérateur</legend>
		<table class="category_page">
			<tr>
				<th class="entete_category">ID</th>
				<th class="entete_category">Nom</th>
				<th class="entete_category">Prénom</th>
				<th class="entete_category">Date de naissance</th>
			</tr>
			<tr>
				<td>{{ operator.id }} </td>
				<td>{{ operator.firstname }} </td>
				<td>{{ operator.lastname }} </td>
				<td>{{ operator.dateofbirth }} </td>
			</tr>
		</table>
	</fieldset>
	{% set indice_category= 1 %}
	{% for category in formation.categories %}
		<br/>
		<fieldset class="category">
		<legend class="category_title">
			Catégorie : {{ category.name }} ({{ category.ordre }})
		</legend>
		<div class="operatorformation_task_tab">
			<table>
				<tr>
					<td class="task_name">Nom tache</td>
					<td class="task_order">Ordre tache</td>
				</tr>
				{% set task_checked= true %}
				{% for task in category.tasks %}
						<tr>
							<td>{{ task.name }}</td>
							<td>{{ task.ordre }}</td>
							<td>
								<div class="task_validator">
									<a href="{{ path('AppCofidurBundle_operatortask_add', {'idOpForm': operatorformation.id, 'idCategory': category.id, 'idTask': task.id 	}) }}">
										Valider
									</a>
								</div>
							</td>
						</tr>
				{% endfor %}
			</table>
		</div>
		<div id="operatorformation_informations{{ indice_category }}" class="operatorformation_informations">
			<table>
				<tr>
					<th>ID Catégorie</th>
					<td>{{ category.id }}</td>
				</tr>
				<tr>
					<th>Date signature</th>
					<td>TODO</td>
				</tr>
				<tr>
					<th>Signature</th>
					<td>TODO</td>
				</tr>
				<tr>
					<th>Nombre d'heures</th>
					<td>TODO</td>
				</tr>
				<tr>
					<th>ID formateur</th>
					<td>TODO</td>
				</tr>
			</table>
		</div>
		<div>
			<fieldset>
				<legend>
					<!-- A afficher si la categorie est validée -->
					{% set validated_category="" %}
					{% for opeCat in operatorformation.operatorcategories %}
						{% if category.id == opeCat.idCategory %}
							{% set validated_category= true %}
							Catégorie validée !
							<br/>
						{% endif %}
					{% endfor %}

					{% if not validated_category %}
						<a href="{{ path('AppCofidurBundle_operatorcategory_add', {'idOpForm': operatorformation.id, 'idCategory': category.id}) }}">
							<button id="validate">Valider la catégorie</button>
						</a>
						<br/>
					{% endif %}
				</legend>
				<table>
					<tr>
						<td>
							<a href="{{ path('AppCofidurBundle_operatorcategory_edit', {'idOpForm': operatorformation.id, 'idCategory': category.id}) }}">EDITER</a>
						</td>
						<td>
							<a href="{{ path('AppCofidurBundle_operatorcategory_delete', {'idOpForm': operatorformation.id, 'idCategory': category.id}) }}">SUPPRIMER</a>
						</td>
					</tr>
				</table>
				<button id="details{{ indice_category }}" name="details" value="details" onclick="show_details({{ indice_category }}, this.id)">Détails</button>
			</fieldset>
		</div>
		</fieldset>
		{% set indice_category= indice_category+1 %}
{% endfor %}
{% endblock %}

{% block sidebar %}

{% endblock %}