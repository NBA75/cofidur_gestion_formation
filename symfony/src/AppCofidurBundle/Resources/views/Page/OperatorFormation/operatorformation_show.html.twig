{% extends 'AppCofidurBundle::Page/OperatorFormation/operatorformation.html.twig' %}

{% block sidebar_nav %}
    <h2><em><a href="javascript:history.go(-1)">Retour</a></em></h2>
    {{ parent() }}
{% endblock %}

{% block body %}
	<h1>Formation d'un opérateur (FFO)</h1>

	<script type="text/javascript">
		function show_details(indice_category){
			var details_block= document.getElementById("operatorformation_informations".concat(indice_category));
			var details_button= document.getElementById("details".concat(indice_category));

            /*** Rédéfinit le style de la partie des détails ***/
            /* Si le style a déjà été définit comme "à afficher", on le cache */
			if(details_block.style.display == "block"){
				details_block.style.display= "none";
            /* Si le style n'a pas été redéfinit ou qu'il est définit comme caché, on l'affiche */
			} else {
				details_block.style.display= "block";
			}
		}

		function validate_task(id_task_button){
			var task_button= document.getElementById(id_task_button);
//			task_button.style.display= "none";
		}

		{#function validation_box(opeform_id, cat_id, custom_anchor){#}
			{#var operatorcat_id= document.getElementById(opeform_id);#}
			{#if(confirm('Valider la catégorie ?')){#}
				{#alert('opeform_id');#}
				{#<a href="{{ path('AppCofidurBundle_operatorcategory_edit',{'idOpForm': opeform_id, 'idCategory': cat_id}) }}#custom_anchor$cat_id">#}
					{#Blabla#}
				{#</a>#}
				{#return true;#}
			{#} else {#}
				{#alert($cat_id);#}
				{#return false;#}
			{#}#}
		{#}#}
	</script>

	<!--
		INFORMATIONS SUR LE TUTEUR, L'OPERATEUR ET LES DATES
	-->
	<fieldset class="sumup operatorformation">
		<legend>Informations</legend>
		<table class="infos operator">
			<tr>
				<th>Nom</th>
				<td> {{ operatorformation.operator.firstname }}</td>
			</tr>
			<tr>
				<th>Prénom</th>
				<td> {{ operatorformation.operator.lastname }}</td>
			</tr>
			<tr>
				<th>Service</th>
				<td > SERVICE--{{ operatorformation.operator }}??</td>
			</tr>
		</table>

		<table class="infos tutor">
            <tr>
				<th>Tuteur</th>
            </tr>
            <tr>
				<td>{{ operatorformation.former.firstName }} {{ operatorformation.former.lastName }}</td>
            </tr>
		</table>

		<table class="dates operatorformation">
			<tr>
				<th>Date de début</th>
				<td>{{ operatorformation.dateBegin|date("m/d/Y")}}</td>
			</tr>
			<tr>
				<th>Date de fin</th>
				<td>{{ operatorformation.dateEnd|date("m/d/Y") }}</td>
			</tr>
			<tr>
                {% if operatorformation.formation.validityTime > 0 %}
                    <th>Temps avant invalidité</th>
                    {% if operatorformation.getRemainingTime() > 0 %}
                        <td>{{ operatorformation.getRemainingTime() }} jour(s)</td>
                    {% else  %}
                        <td class="error">La formation n'est pas ou plus valide</td>
                    {% endif %}
                {% else %}
                    <th colspan="2">Pas d'invalidation sur cette formation</th>
                {% endif %}
            </tr>

		</table>
	</fieldset>

	<!--
		RESUME DE LA FORMATION
	-->
	<fieldset class="sumup formation">
		<legend>Résumé de la formation</legend>
		<table class="infos formation">
			<tr>
				<th>Nom de la formation</th>
				<td class="formation name"> {{ operatorformation.formation.name }}</td>
			</tr>
			<tr>
				<th>Objectif visé</th>
				<td > {{ operatorformation.formation.goal}}</td>
			</tr>
			<tr>
				<th>Moyens pédagogiques</th>
				<td > {{ operatorformation.formation.placesMaterialRessources }}</td>
			</tr>
		</table>
	</fieldset>

	<!--
		SUIVI DE L'AVANCEMENT DE LA FORMATION
	-->
	<fieldset class="details operatorformation">
		<legend>Etapes de la formation :</legend>
	{% set indice_category= 1 %}
		<!--
			 Affichage de chaque catégorie
			 On liste toutes les catégories de la formation et on rempli l'avancement de chaque catégorie. Si la
			 catégorie n'existe pas dans l'operatorformation, c'est qu'elle a été rajoutée après que l'operatorformation
			 a été créée. (opeCat à null dans ce cas)
		-->
	{% for category in operatorformation.formation.categories %}
        {% include 'AppCofidurBundle::Page/OperatorCategory/operatorcategory_show.html.twig' %}

        {% set indice_category= indice_category+1 %}
    {% endfor %}

	</fieldset>
	<br/>

{% endblock %}
